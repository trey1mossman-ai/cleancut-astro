---
interface FAQ {
  question: string;
  answer: string;
}

interface Props {
  faqs: FAQ[];
  title?: string;
  backgroundImage: string;
  imageAlt?: string;
}

const { faqs, title = "Frequently Asked Questions", backgroundImage, imageAlt = "Clean Cut Painting & Handyman services" } = Astro.props;
---

<section class="py-16 relative">
  <!-- Background Image -->
  <img
    src={backgroundImage}
    alt={imageAlt}
    class="absolute inset-0 w-full h-full object-cover"
    loading="lazy"
  />
  
  <!-- Black Overlay -->
  <div class="absolute inset-0 bg-black/60"></div>
  
  <!-- Content -->
  <div class="container-custom relative z-10">
    <!-- Header -->
    <div class="text-center mb-10">
      <h2 class="text-3xl lg:text-4xl font-display font-bold text-white mb-3">
        {title}
      </h2>
      <p class="text-white/80">
        Get answers to common questions about our services
      </p>
    </div>

    <!-- FAQ List -->
    <div class="faq-container max-w-3xl mx-auto space-y-3">
      {faqs.map((faq, index) => (
        <div
          class="faq-item bg-white/95 backdrop-blur-sm rounded-lg overflow-hidden transition-all duration-300"
          data-faq-index={index}
        >
          <button
            class="faq-trigger w-full px-5 py-4 flex items-center justify-between text-left hover:bg-white transition-colors duration-200"
            aria-expanded="false"
          >
            <span class="text-[#144787] font-semibold pr-4 leading-snug text-sm sm:text-base">
              {faq.question}
            </span>
            <span class="faq-icon flex-shrink-0 w-6 h-6 rounded-full bg-sky-100 flex items-center justify-center transition-transform duration-300">
              <svg class="w-4 h-4 text-sky-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
              </svg>
            </span>
          </button>
          <div class="faq-content hidden px-5 pt-2 pb-5">
            <p class="text-gray-600 leading-relaxed text-sm sm:text-base">
              {faq.answer}
            </p>
          </div>
        </div>
      ))}
    </div>
  </div>
</section>

<style>
  .faq-item {
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
  }

  .faq-item:hover {
    box-shadow: 0 6px 20px rgba(0, 0, 0, 0.2);
  }

  .faq-trigger[aria-expanded="true"] .faq-icon {
    transform: rotate(180deg);
    background-color: #0ea5e9;
  }

  .faq-trigger[aria-expanded="true"] .faq-icon svg {
    color: white;
  }
</style>

<script>
  function initFAQWithImage() {
    const containers = document.querySelectorAll('.faq-container');

    containers.forEach(container => {
      const triggers = container.querySelectorAll('.faq-trigger');

      triggers.forEach(trigger => {
        trigger.addEventListener('click', () => {
          const content = trigger.nextElementSibling;
          const isExpanded = trigger.getAttribute('aria-expanded') === 'true';

          triggers.forEach(otherTrigger => {
            if (otherTrigger !== trigger) {
              otherTrigger.setAttribute('aria-expanded', 'false');
              const otherContent = otherTrigger.nextElementSibling;
              if (otherContent) {
                otherContent.classList.add('hidden');
              }
            }
          });

          trigger.setAttribute('aria-expanded', (!isExpanded).toString());
          if (content) {
            content.classList.toggle('hidden', isExpanded);
          }
        });
      });
    });
  }

  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initFAQWithImage);
  } else {
    initFAQWithImage();
  }
</script>
