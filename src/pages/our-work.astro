---
import Layout from '../layouts/Layout.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
import FloatingCallButton from '../components/FloatingCallButton.astro';
import Lightbox from '../components/Lightbox.astro';

// Gallery data organized by category - ALT TEXT OPTIMIZED FOR LOCAL SEO
const galleryCategories = [
  {
    id: 'interior',
    title: 'Interior Painting',
    images: [
      {
        src: '/images/services-optimized/interior-painting/6t4a6783.webp',
        alt: 'Professional interior wall painting by Clean Cut Painting in Decatur IL'
      },
      {
        src: '/images/services-optimized/interior-painting/6t4a6843.webp',
        alt: 'Interior painting project completed in Springfield Illinois home'
      },
      {
        src: '/images/services-optimized/interior-painting/6t4a6822-2.webp',
        alt: 'Custom interior color selection and trim painting in Central Illinois'
      },
      {
        src: '/images/services-optimized/interior-painting/6t4a6873.webp',
        alt: 'Beautifully painted bedroom by interior painters in Decatur Illinois'
      },
      {
        src: '/images/services-optimized/interior-painting/2.webp',
        alt: 'Kitchen interior painting with white cabinets in Macon County IL'
      },
      {
        src: '/images/services-optimized/interior-painting/march-26.webp',
        alt: 'Clean Cut interior painting project in Springfield IL residence'
      }
    ]
  },
  {
    id: 'exterior',
    title: 'Exterior Painting',
    images: [
      {
        src: '/images/services-optimized/exterior-painting/552533568_18029634086725762_2275584699687083915_n.webp',
        alt: 'Professional exterior house painting with blue siding in Decatur IL'
      },
      {
        src: '/images/services-optimized/exterior-painting/519661187_18021421895725762_3375230967664930050_n.webp',
        alt: 'Exterior painting transformation on Springfield Illinois home'
      },
      {
        src: '/images/services-optimized/exterior-painting/2-2.webp',
        alt: 'Quality exterior home painting by Central Illinois contractors'
      },
      {
        src: '/images/services-optimized/exterior-painting/1.webp',
        alt: 'Residential exterior painting with fresh finish in Decatur Illinois'
      },
      {
        src: '/images/services-optimized/exterior-painting/march-25.webp',
        alt: 'Completed exterior painting project in Sangamon County IL'
      },
      {
        src: '/images/services-optimized/exterior-painting/3-3.webp',
        alt: 'Professional exterior painting service by Clean Cut in Central IL'
      }
    ]
  },
  {
    id: 'cabinets',
    title: 'Cabinet Refinishing',
    images: [
      {
        src: '/images/services-optimized/cabinet-refinishing/copy-of-2.webp',
        alt: 'Professional cabinet refinishing by Clean Cut Painting in Decatur IL'
      },
      {
        src: '/images/Home Page/Residential Services/CC _ Home Page Photos_Cabinet Refinishing.webp',
        alt: 'Kitchen cabinet transformation in Springfield Illinois home'
      }
    ]
  },
  {
    id: 'deck',
    title: 'Deck Staining',
    images: [
      {
        src: '/images/services-optimized/deck-staining/june-26.webp',
        alt: 'Professional deck staining and restoration in Decatur Illinois'
      },
      {
        src: '/images/services-optimized/deck-staining/543742067_18027770942725762_6809030153408573163_n.webp',
        alt: 'Deck staining project with beautiful finish in Central Illinois'
      },
      {
        src: '/images/services-optimized/deck-staining/544063718_18027770906725762_8407492106307251719_n.webp',
        alt: 'Deck refinishing and staining service in Springfield IL'
      },
      {
        src: '/images/services-optimized/deck-staining/543046979_18027770933725762_2680363837880653339_n.webp',
        alt: 'Professional deck staining for outdoor living in Macon County'
      },
      {
        src: '/images/services-optimized/deck-staining/april-7.webp',
        alt: 'Deck staining and sealing project in Decatur IL'
      },
      {
        src: '/images/services-optimized/deck-staining/april-6.webp',
        alt: 'Complete deck restoration and staining in Central Illinois'
      }
    ]
  },
  {
    id: 'commercial',
    title: 'Commercial Projects',
    images: [
      {
        src: '/images/services-optimized/commercial-projects/2-3.webp',
        alt: 'Commercial painting and renovation project in Decatur Illinois'
      },
      {
        src: '/images/services-optimized/commercial-projects/april-10.webp',
        alt: 'Commercial exterior painting service in Springfield IL'
      },
      {
        src: '/images/Home Page/Recent Projects/CC _ Home Page Photos_Recent Work_Commerical Exterior.webp',
        alt: 'Commercial building exterior painting in Central Illinois'
      }
    ]
  },
  {
    id: 'other',
    title: 'Additional Projects',
    images: [
      {
        src: '/images/Home Page/Recent Projects/CC _ Home Page Photos_Recent Work_Pool Repair & Repaint.webp',
        alt: 'Pool area repair and repainting project in Decatur IL'
      },
      {
        src: '/images/Home Page/Recent Projects/CC _ Home Page Photos_Recent Work_Garage Repaint-12.webp',
        alt: 'Garage floor and wall repainting in Springfield Illinois'
      },
      {
        src: '/images/Home Page/Recent Projects/CC _ Home Page Photos_Recent Work_Garage Repaint-13.webp',
        alt: 'Completed garage renovation and painting in Decatur Illinois'
      },
      {
        src: '/images/Home Page/Recent Projects/CC _ Home Page Photos_Recent Work_Deck Rebuild.webp',
        alt: 'Complete deck rebuild and refinishing in Central Illinois'
      },
      {
        src: '/images/Home Page/Recent Projects/CC _ Home Page Photos_Recent Work_Deck & Boat House Rebuild.webp',
        alt: 'Deck and boat house rebuild by Clean Cut in Macon County IL'
      }
    ]
  }
];

// Calculate total images
const totalImages = galleryCategories.reduce((sum, cat) => sum + cat.images.length, 0);

// Video gallery data with thumbnails and titles
const videos = [
  {
    id: 'video-1',
    src: 'https://player.vimeo.com/progressive_redirect/playback/919437556/rendition/1080p/file.mp4?loc=external&log_user=0&signature=eb333e5eeba651e3cdd540e12b7fd79719a319bd5b3122d8c99aa0b625442058',
    thumbnail: '/images/services-optimized/interior-painting/6t4a6783.webp',
    title: 'Interior Wall Painting',
    category: 'Interior'
  },
  {
    id: 'video-2',
    src: 'https://player.vimeo.com/progressive_redirect/playback/919436979/rendition/1080p/file.mp4?loc=external&log_user=0&signature=f74928338fb4138169d8747388433979e7cae5e41d6e0c841cdee977eeaac004',
    thumbnail: '/images/services-optimized/interior-painting/6t4a6843.webp',
    title: 'Bedroom Transformation',
    category: 'Interior'
  },
  {
    id: 'video-3',
    src: 'https://player.vimeo.com/progressive_redirect/playback/919437138/rendition/1080p/file.mp4?loc=external&log_user=0&signature=739ef3e8456ed249af4a6d9968231c76b93d06f27f2c4bbd06bae63c9aff83ce',
    thumbnail: '/images/services-optimized/exterior-painting/552533568_18029634086725762_2275584699687083915_n.webp',
    title: 'Exterior Home Painting',
    category: 'Exterior'
  },
  {
    id: 'video-4',
    src: 'https://player.vimeo.com/progressive_redirect/playback/919437399/rendition/1080p/file.mp4?loc=external&log_user=0&signature=6fe890952f01340bafca0084977087848d1b615dd9d6616ad3b546e133556576',
    thumbnail: '/images/services-optimized/exterior-painting/519661187_18021421895725762_3375230967664930050_n.webp',
    title: 'House Exterior Refresh',
    category: 'Exterior'
  },
  {
    id: 'video-5',
    src: 'https://player.vimeo.com/progressive_redirect/playback/919437263/rendition/1080p/file.mp4?loc=external&log_user=0&signature=5ef81898bc2b2c14a72352b272d76e9609c49156c3cb19dd66f9fd0f4b91c4c3',
    thumbnail: '/images/services-optimized/deck-staining/june-26.webp',
    title: 'Deck Staining Project',
    category: 'Deck'
  },
  {
    id: 'video-6',
    src: 'https://player.vimeo.com/progressive_redirect/playback/919437458/rendition/1080p/file.mp4?loc=external&log_user=0&signature=9c3e481f7d5f313ae5e65ac5c975b0ee8069d4f4804b24b7bc932659c0f08470',
    thumbnail: '/images/services-optimized/interior-painting/6t4a6873.webp',
    title: 'Living Room Makeover',
    category: 'Interior'
  },
  {
    id: 'video-7',
    src: 'https://player.vimeo.com/progressive_redirect/playback/919437519/rendition/1080p/file.mp4?loc=external&log_user=0&signature=7bd056d5c3a43623fc9caee83683fac77e7da5f64eee0143682a920ea292500f',
    thumbnail: '/images/services-optimized/cabinet-refinishing/copy-of-2.webp',
    title: 'Cabinet Refinishing',
    category: 'Cabinets'
  },
  {
    id: 'video-8',
    src: 'https://player.vimeo.com/progressive_redirect/playback/919437335/rendition/1080p/file.mp4?loc=external&log_user=0&signature=c63f4c94c30150aad1912cb8e1b384a31028744d4daa1c39cb347b63c46e60b5',
    thumbnail: '/images/services-optimized/commercial-projects/2-3.webp',
    title: 'Commercial Project',
    category: 'Commercial'
  }
];

// Filter configuration with counts
const filters = [
  { id: 'all', label: 'All Projects', count: totalImages },
  ...galleryCategories.map(cat => ({
    id: cat.id,
    label: cat.title,
    count: cat.images.length
  }))
];
---

<Layout
  title="Our Work | Clean Cut Painting & Handyman Gallery"
  description="Browse our portfolio of painting and handyman projects across Decatur, Springfield, and Central Illinois. See our quality interior, exterior, cabinet, and deck work."
>
  <Header />

  <main>
    <!-- Hero Section -->
    <section class="relative min-h-[500px] py-20 lg:py-24 overflow-hidden">
      <img
        src="/images/Home Page/Residential Services/CC _ Home Page Photos_Interior Painting.webp"
        alt="Our work portfolio - professional painting and handyman services in Decatur and Central Illinois"
        class="absolute inset-0 w-full h-full object-cover"
      >
      <div class="absolute inset-0 bg-gradient-to-br from-[#144787]/85 via-[#144787]/75 to-[#144787]/65 lg:from-black/70 lg:via-black/60 lg:to-black/50 backdrop-blur-md lg:backdrop-blur-none"></div>
      <div class="container-custom relative z-10">
        <div class="max-w-4xl mx-auto text-center text-white">
          <h1 class="text-3xl sm:text-4xl lg:text-5xl xl:text-6xl font-display font-bold mb-6 drop-shadow-lg">
            Our Work
          </h1>
          <p class="text-lg sm:text-xl lg:text-2xl text-white/95 font-medium max-w-3xl mx-auto">
            Browse our portfolio of completed projects across Decatur, Springfield, and Central Illinois. Quality craftsmanship in every detail.
          </p>
        </div>
      </div>
    </section>

    <!-- Gallery Section -->
    <section class="py-16 bg-gray-50">
      <div class="container-custom">
        <div class="text-center mb-8">
          <h2 class="text-3xl lg:text-4xl font-display font-bold text-[#144787] mb-4">
            Project Gallery
          </h2>
          <p class="text-lg text-gray-600 max-w-2xl mx-auto">
            Explore our comprehensive portfolio showcasing quality craftsmanship across all our services
          </p>
        </div>

        <!-- Filter Bar -->
        <div class="py-4 mb-8">
          <div class="flex flex-wrap justify-center gap-2 sm:gap-3" role="tablist" aria-label="Filter gallery by project type">
            {filters.map((filter, index) => (
              <button
                type="button"
                role="tab"
                aria-selected={index === 0 ? "true" : "false"}
                aria-controls="gallery-grid"
                data-filter={filter.id}
                class:list={[
                  "filter-btn group relative px-4 py-2.5 sm:px-5 sm:py-2.5 rounded-full font-semibold text-sm sm:text-base transition-all duration-300 focus:outline-none focus-visible:ring-2 focus-visible:ring-sky-400 focus-visible:ring-offset-2",
                  index === 0 
                    ? "bg-sky-400 text-white shadow-lg shadow-sky-400/30" 
                    : "bg-white text-gray-700 shadow-md hover:shadow-lg hover:bg-gray-50"
                ]}
              >
                <span class="relative z-10">{filter.label}</span>
                <span class:list={[
                  "ml-1.5 px-2 py-0.5 text-xs rounded-full transition-colors duration-300",
                  index === 0
                    ? "bg-white/25 text-white"
                    : "bg-gray-100 text-gray-500 group-hover:bg-sky-100 group-hover:text-sky-600"
                ]}>
                  {filter.count}
                </span>
              </button>
            ))}
          </div>
          
          <!-- Active filter indicator -->
          <div class="mt-4 text-center">
            <p id="filter-status" class="text-sm text-gray-500 transition-opacity duration-300">
              Showing <span class="font-semibold text-[#144787]" id="filter-count">{totalImages}</span> projects
            </p>
          </div>
        </div>

        <!-- Gallery Grid -->
        <div id="gallery-grid" class="relative min-h-[400px]">
          {galleryCategories.map((category, index) => (
            <div 
              class="gallery-category transition-all duration-500 ease-out"
              data-category={category.id}
            >
              <h3 class="category-title text-2xl lg:text-3xl font-display font-bold text-[#144787] mb-8 transition-all duration-300">
                {category.title}
              </h3>
              <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 lg:gap-8 mb-12 lg:mb-16">
                {category.images.map((image, imgIndex) => (
                  <div 
                    class="gallery-item group overflow-hidden rounded-xl shadow-md hover:shadow-2xl transition-all duration-500 h-64 sm:h-72 transform hover:-translate-y-1"
                    data-category={category.id}
                    style={`animation-delay: ${imgIndex * 50}ms`}
                  >
                    <div class="relative w-full h-full overflow-hidden">
                      <img
                        src={image.src}
                        alt={image.alt}
                        class="w-full h-full object-cover transform group-hover:scale-110 transition-transform duration-700 ease-out"
                        loading="lazy"
                        data-lightbox-gallery="our-work-gallery"
                      />
                      <!-- Hover overlay -->
                      <div class="absolute inset-0 bg-gradient-to-t from-[#144787]/80 via-[#144787]/20 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300">
                        <div class="absolute bottom-0 left-0 right-0 p-4 transform translate-y-4 group-hover:translate-y-0 transition-transform duration-300">
                          <p class="text-white text-sm font-medium line-clamp-2">{image.alt}</p>
                        </div>
                      </div>
                      <!-- Zoom icon -->
                      <div class="absolute top-4 right-4 w-10 h-10 bg-white/90 rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transform scale-75 group-hover:scale-100 transition-all duration-300 shadow-lg">
                        <svg class="w-5 h-5 text-[#144787]" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0zM10 7v3m0 0v3m0-3h3m-3 0H7" />
                        </svg>
                      </div>
                    </div>
                  </div>
                ))}
              </div>
            </div>
          ))}
        </div>
      </div>
    </section>

    <!-- Video Gallery Section -->
    <section class="py-16 bg-white">
      <div class="container-custom">
        <div class="text-center mb-12">
          <h2 class="text-3xl lg:text-4xl font-display font-bold text-[#144787] mb-4">
            Video Gallery
          </h2>
          <p class="text-lg text-gray-600 max-w-2xl mx-auto">
            Watch our team in action and see the quality craftsmanship we bring to every project
          </p>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 lg:gap-8">
          {videos.map((video) => (
            <div 
              class="video-card group relative aspect-video rounded-xl overflow-hidden shadow-lg hover:shadow-2xl transition-all duration-500 cursor-pointer transform hover:-translate-y-1"
              data-video-id={video.id}
              data-video-src={video.src}
            >
              <!-- Thumbnail -->
              <img
                src={video.thumbnail}
                alt={`${video.title} - Watch video`}
                class="absolute inset-0 w-full h-full object-cover transition-transform duration-700 group-hover:scale-110"
                loading="lazy"
              />
              
              <!-- Gradient overlay -->
              <div class="absolute inset-0 bg-gradient-to-t from-[#144787]/90 via-[#144787]/30 to-transparent opacity-80 group-hover:opacity-90 transition-opacity duration-300"></div>
              
              <!-- Play button -->
              <div class="absolute inset-0 flex items-center justify-center">
                <div class="play-btn w-16 h-16 sm:w-20 sm:h-20 bg-white/95 rounded-full flex items-center justify-center shadow-2xl transform group-hover:scale-110 transition-all duration-300 group-hover:bg-sky-400">
                  <svg class="w-7 h-7 sm:w-8 sm:h-8 text-[#144787] group-hover:text-white ml-1 transition-colors duration-300" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M8 5v14l11-7z"/>
                  </svg>
                </div>
              </div>
              
              <!-- Title and category -->
              <div class="absolute bottom-0 left-0 right-0 p-4 sm:p-5">
                <span class="inline-block px-2.5 py-1 bg-sky-400/90 text-white text-xs font-semibold rounded-full mb-2">
                  {video.category}
                </span>
                <h3 class="text-white font-display font-bold text-base sm:text-lg drop-shadow-lg">
                  {video.title}
                </h3>
              </div>
              
              <!-- Video container (hidden until clicked) -->
              <div class="video-container absolute inset-0 hidden">
                <video 
                  class="w-full h-full object-cover" 
                  controls 
                  preload="none"
                  playsinline
                >
                  <source src={video.src} type="video/mp4" />
                </video>
              </div>
              
              <!-- Loading spinner -->
              <div class="loading-spinner absolute inset-0 hidden items-center justify-center bg-[#144787]/80">
                <div class="w-12 h-12 border-4 border-white/30 border-t-white rounded-full animate-spin"></div>
              </div>
            </div>
          ))}
        </div>
      </div>
    </section>

    <!-- CTA Section -->
    <section class="py-16 relative overflow-hidden" style="background-image: url('/patterns/pattern-04.webp'); background-size: cover; background-position: center;">
      <div class="absolute inset-0 bg-[#144787]/90"></div>
      <div class="container-custom relative z-10">
        <div class="max-w-3xl mx-auto text-center">
          <h2 class="text-3xl lg:text-4xl font-display font-bold text-white mb-6">
            Ready to Start Your Project?
          </h2>
          <p class="text-lg text-white/90 mb-8">
            Let's transform your space with professional painting and handyman services. Contact us today for a free estimate!
          </p>
          <div class="flex flex-col sm:flex-row gap-4 justify-center">
            <a href="/contact" class="px-8 py-4 bg-sky-400 text-white font-bold text-lg rounded-lg hover:bg-sky-500 transform hover:-translate-y-0.5 transition-all duration-300 shadow-xl">
              Get Free Estimate
            </a>
            <a href="tel:+12173307310" class="px-8 py-4 bg-white text-[#144787] font-bold text-lg rounded-lg hover:bg-gray-100 transform hover:-translate-y-0.5 transition-all duration-300 shadow-xl">
              Call (217) 330-7310
            </a>
          </div>
        </div>
      </div>
    </section>
  </main>

  <Footer />
  <FloatingCallButton />
  <Lightbox />
</Layout>

<style>
  @reference "tailwindcss";
  
  /* Filter button active state */
  .filter-btn.active {
    @apply bg-sky-400 text-white shadow-lg shadow-sky-400/30;
  }
  
  .filter-btn.active span:last-child {
    @apply bg-white/25 text-white;
  }
  
  /* Gallery item animations */
  .gallery-item {
    opacity: 1;
    transform: translateY(0);
  }
  
  .gallery-item.hiding {
    opacity: 0;
    transform: translateY(20px) scale(0.95);
    pointer-events: none;
  }
  
  .gallery-item.showing {
    animation: fadeInUp 0.4s ease-out forwards;
  }
  
  @keyframes fadeInUp {
    from {
      opacity: 0;
      transform: translateY(20px) scale(0.95);
    }
    to {
      opacity: 1;
      transform: translateY(0) scale(1);
    }
  }
  
  /* Category section animations */
  .gallery-category {
    opacity: 1;
    max-height: 5000px;
    overflow: visible;
  }
  
  .gallery-category.hidden-category {
    opacity: 0;
    max-height: 0;
    overflow: hidden;
    margin-bottom: 0;
    pointer-events: none;
  }
  
  /* Hide category titles when filtering single category */
  .gallery-category .category-title.hidden-title {
    opacity: 0;
    max-height: 0;
    margin-bottom: 0;
    overflow: hidden;
  }
  
  /* Line clamp for alt text overlay */
  .line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
  
  /* Video card transitions */
  .video-card img,
  .video-card .play-btn,
  .video-card .absolute {
    transition: all 0.4s ease-out;
  }
  
  .video-card .video-container {
    z-index: 20;
  }
  
  .video-card .video-container video {
    background: #144787;
  }
  
  /* Loading spinner animation */
  @keyframes spin {
    to {
      transform: rotate(360deg);
    }
  }
  
  .animate-spin {
    animation: spin 1s linear infinite;
  }
</style>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const filterButtons = document.querySelectorAll('.filter-btn');
    const categories = document.querySelectorAll('.gallery-category');
    const galleryItems = document.querySelectorAll('.gallery-item');
    const filterCount = document.getElementById('filter-count');
    const filterStatus = document.getElementById('filter-status');
    
    // Image counts by category
    const imageCounts: Record<string, number> = {
      all: 28,
      interior: 6,
      exterior: 6,
      cabinets: 2,
      deck: 6,
      commercial: 3,
      other: 5
    };
    
    let activeFilter = 'all';
    
    function setActiveFilter(filterId: string) {
      activeFilter = filterId;
      
      // Update button states
      filterButtons.forEach(btn => {
        const btnFilter = btn.getAttribute('data-filter');
        const isActive = btnFilter === filterId;
        
        btn.classList.toggle('active', isActive);
        btn.setAttribute('aria-selected', isActive ? 'true' : 'false');
        
        // Update button styling
        if (isActive) {
          btn.classList.remove('bg-white', 'text-gray-700', 'hover:bg-gray-50');
          btn.classList.add('bg-sky-400', 'text-white', 'shadow-lg', 'shadow-sky-400/30');
        } else {
          btn.classList.add('bg-white', 'text-gray-700', 'hover:bg-gray-50');
          btn.classList.remove('bg-sky-400', 'text-white', 'shadow-lg', 'shadow-sky-400/30');
        }
      });
      
      // Update count display
      if (filterCount) {
        filterCount.textContent = String(imageCounts[filterId] || 0);
      }
      
      // Animate categories and items
      if (filterId === 'all') {
        // Show all categories with titles
        categories.forEach(cat => {
          cat.classList.remove('hidden-category');
          const title = cat.querySelector('.category-title');
          if (title) title.classList.remove('hidden-title');
        });
        
        // Show all items with staggered animation
        galleryItems.forEach((item, index) => {
          item.classList.remove('hiding');
          item.classList.add('showing');
          (item as HTMLElement).style.animationDelay = `${index * 30}ms`;
        });
      } else {
        // Show only selected category
        categories.forEach(cat => {
          const catId = cat.getAttribute('data-category');
          const isVisible = catId === filterId;
          
          if (isVisible) {
            cat.classList.remove('hidden-category');
            // Hide title when showing single category (context is clear from filter)
            const title = cat.querySelector('.category-title');
            if (title) title.classList.add('hidden-title');
          } else {
            cat.classList.add('hidden-category');
          }
        });
        
        // Animate visible items
        const visibleItems = document.querySelectorAll(`.gallery-item[data-category="${filterId}"]`);
        galleryItems.forEach(item => {
          const itemCat = item.getAttribute('data-category');
          if (itemCat === filterId) {
            item.classList.remove('hiding');
            item.classList.add('showing');
          } else {
            item.classList.add('hiding');
            item.classList.remove('showing');
          }
        });
        
        visibleItems.forEach((item, index) => {
          (item as HTMLElement).style.animationDelay = `${index * 50}ms`;
        });
      }
      
      // Scroll to gallery if user is below it
      const galleryGrid = document.getElementById('gallery-grid');
      if (galleryGrid) {
        const rect = galleryGrid.getBoundingClientRect();
        if (rect.top < -100) {
          galleryGrid.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }
      }
    }
    
    // Add click handlers
    filterButtons.forEach(btn => {
      btn.addEventListener('click', () => {
        const filterId = btn.getAttribute('data-filter');
        if (filterId && filterId !== activeFilter) {
          setActiveFilter(filterId);
        }
      });
    });
    
    // Keyboard navigation
    filterButtons.forEach((btn, index) => {
      btn.addEventListener('keydown', (e) => {
        const key = (e as KeyboardEvent).key;
        let newIndex = index;
        
        if (key === 'ArrowRight' || key === 'ArrowDown') {
          e.preventDefault();
          newIndex = (index + 1) % filterButtons.length;
        } else if (key === 'ArrowLeft' || key === 'ArrowUp') {
          e.preventDefault();
          newIndex = (index - 1 + filterButtons.length) % filterButtons.length;
        } else if (key === 'Home') {
          e.preventDefault();
          newIndex = 0;
        } else if (key === 'End') {
          e.preventDefault();
          newIndex = filterButtons.length - 1;
        }
        
        if (newIndex !== index) {
          (filterButtons[newIndex] as HTMLElement).focus();
          const filterId = filterButtons[newIndex].getAttribute('data-filter');
          if (filterId) setActiveFilter(filterId);
        }
      });
    });
    
    // ============================================
    // VIDEO GALLERY - Click to Play Functionality
    // ============================================
    
    const videoCards = document.querySelectorAll('.video-card');
    
    videoCards.forEach(card => {
      card.addEventListener('click', function(this: HTMLElement) {
        const videoContainer = this.querySelector('.video-container') as HTMLElement;
        const loadingSpinner = this.querySelector('.loading-spinner') as HTMLElement;
        const thumbnail = this.querySelector('img') as HTMLElement;
        const overlay = this.querySelectorAll('.absolute')[1] as HTMLElement; // gradient overlay
        const playBtn = this.querySelector('.play-btn')?.parentElement as HTMLElement;
        const titleArea = this.querySelector('.absolute.bottom-0') as HTMLElement;
        const video = videoContainer?.querySelector('video') as HTMLVideoElement;
        
        if (!videoContainer || !video) return;
        
        // If already playing, don't do anything
        if (videoContainer.classList.contains('playing')) return;
        
        // Show loading spinner
        loadingSpinner?.classList.remove('hidden');
        loadingSpinner?.classList.add('flex');
        
        // Hide thumbnail, overlay, play button, and title with fade
        thumbnail?.classList.add('opacity-0');
        overlay?.classList.add('opacity-0');
        playBtn?.classList.add('opacity-0', 'scale-75');
        titleArea?.classList.add('opacity-0', 'translate-y-4');
        
        // Small delay for visual smoothness
        setTimeout(() => {
          // Show video container
          videoContainer.classList.remove('hidden');
          videoContainer.classList.add('playing');
          
          // Hide loading spinner
          loadingSpinner?.classList.add('hidden');
          loadingSpinner?.classList.remove('flex');
          
          // Hide other elements completely
          thumbnail?.classList.add('hidden');
          overlay?.classList.add('hidden');
          playBtn?.classList.add('hidden');
          titleArea?.classList.add('hidden');
          
          // Play the video
          video.play().catch(err => {
            console.log('Autoplay prevented:', err);
            // Show controls so user can manually play
          });
          
          // Remove cursor pointer since video is playing
          (card as HTMLElement).style.cursor = 'default';
        }, 300);
        
        // When video ends, optionally reset to thumbnail
        video.addEventListener('ended', function() {
          // Reset to thumbnail state
          videoContainer.classList.add('hidden');
          videoContainer.classList.remove('playing');
          
          thumbnail?.classList.remove('hidden', 'opacity-0');
          overlay?.classList.remove('hidden', 'opacity-0');
          playBtn?.classList.remove('hidden', 'opacity-0', 'scale-75');
          titleArea?.classList.remove('hidden', 'opacity-0', 'translate-y-4');
          
          (card as HTMLElement).style.cursor = 'pointer';
        }, { once: true });
      });
    });
  });
</script>
